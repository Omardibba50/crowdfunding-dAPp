(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.RaceEvent = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var RaceEvent=(()=>{var c=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var l=Object.getOwnPropertyNames;var h=Object.prototype.hasOwnProperty;var y=(r,e)=>{for(var n in e)c(r,n,{get:e[n],enumerable:!0})},m=(r,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of l(e))!h.call(r,o)&&o!==n&&c(r,o,{get:()=>e[o],enumerable:!(t=b(e,o))||t.enumerable});return r};var w=r=>m(c({},"__esModule",{value:!0}),r);var R={};y(R,{AbortError:()=>a,raceEvent:()=>x});var a=class extends Error{type;code;constructor(e,n){super(e??"The operation was aborted"),this.type="aborted",this.name="AbortError",this.code=n??"ABORT_ERR"}};async function x(r,e,n,t){let o=new a(t?.errorMessage,t?.errorCode);return n?.aborted===!0?Promise.reject(o):new Promise((L,v)=>{function s(){n?.removeEventListener("abort",u),r.removeEventListener(e,d),t?.errorEvent!=null&&r.removeEventListener(t.errorEvent,E)}let d=i=>{try{if(t?.filter?.(i)===!1)return}catch(f){s(),v(f);return}s(),L(i)},E=i=>{s(),v(i.detail)},u=()=>{s(),v(o)};n?.addEventListener("abort",u),r.addEventListener(e,d),t?.errorEvent!=null&&r.addEventListener(t.errorEvent,E)})}return w(R);})();
return RaceEvent}));
